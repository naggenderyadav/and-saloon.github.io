<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A & D Salon - Admin</title>
  <style>
    body{font-family:Arial,sans-serif;background:#f6f7fb;margin:0;padding:0;}
    header{background:#1f3b73;color:#fff;text-align:center;padding:20px;}
    .login,.panel{max-width:420px;margin:40px auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.1);}
    label{display:block;margin:10px 0 5px;}
    input{width:100%;padding:10px;border:1px solid #ccc;border-radius:6px;}
    button{margin-top:12px;width:100%;padding:10px;background:#d4af37;color:#fff;border:none;border-radius:6px;cursor:pointer;}
    table{width:100%;margin-top:20px;border-collapse:collapse;}
    th,td{border:1px solid #ddd;padding:10px;text-align:center;}
    th{background:#1f3b73;color:#fff;}
    select{padding:4px;}
  </style>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
</head>
<body>
  <header>
    <h1>ðŸ”‘ A & D Salon - Admin Panel</h1>
  </header>

  <!-- Login Box -->
  <div class="login" id="loginBox">
    <h3>Staff Login</h3>
    <label>Email</label>
    <input type="email" id="loginEmail" placeholder="Enter staff email">
    <label>Password</label>
    <input type="password" id="loginPass" placeholder="Enter password">
    <button onclick="login()">Login</button>
    <p id="loginMsg" style="color:red;font-weight:bold;"></p>
  </div>

  <!-- Admin Panel -->
  <div class="panel" id="adminPanel" style="display:none;">
    <h3>ðŸ“‹ Manage Todayâ€™s Queue</h3>
    <table>
      <thead>
        <tr><th>Serial</th><th>Date & Time</th><th>Name</th><th>Contact</th><th>Payment</th><th>Status</th></tr>
      </thead>
      <tbody id="queueTable"></tbody>
    </table>
    <button onclick="logout()">Logout</button>
  </div>

<script>
  // ---------- Firebase config ----------
  const firebaseConfig = {
    apiKey: "AIzaSyAQJuNHQBu8OHmmz2DPVSSkv9Mj_l3im_g",
    authDomain: "and-unisex-salon.firebaseapp.com",
    databaseURL: "https://and-unisex-salon-default-rtdb.firebaseio.com",
    projectId: "and-unisex-salon",
    storageBucket: "and-unisex-salon.appspot.com",
    messagingSenderId: "369436182781",
    appId: "1:369436182781:web:893b3b8db919b89bb59694"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
  const auth = firebase.auth();

  // Login
  function login(){
    const email=document.getElementById('loginEmail').value;
    const pass=document.getElementById('loginPass').value;
    firebase.auth().signInWithEmailAndPassword(email,pass)
      .then(()=>{
        document.getElementById('loginBox').style.display='none';
        document.getElementById('adminPanel').style.display='block';
        loadQueue();
      })
      .catch(err=>{
        document.getElementById('loginMsg').innerText=err.message;
      });
  }

  // Logout
  function logout(){
    firebase.auth().signOut().then(()=>{
      document.getElementById('loginBox').style.display='block';
      document.getElementById('adminPanel').style.display='none';
    });
  }

  // Load queue
  function loadQueue(){
    const today=new Date().toISOString().split("T")[0];
    db.ref("bookings/"+today).on("value",snap=>{
      const data=snap.val()||{};
      const tbody=document.getElementById("queueTable");
      tbody.innerHTML="";
      Object.values(data).sort((a,b)=>a.serial.localeCompare(b.serial)).forEach(item=>{
        const tr=document.createElement("tr");
        tr.innerHTML=`
          <td>${item.serial}</td>
          <td>${item.datetime}</td>
          <td>${item.name}</td>
          <td>${item.contact}</td>
          <td>
            <select onchange="updateField('${today}','${item.serial}','paymentStatus',this.value)">
              <option ${item.paymentStatus=="Pending"?"selected":""}>Pending</option>
              <option ${item.paymentStatus=="Done"?"selected":""}>Done</option>
            </select>
          </td>
          <td>
            <select onchange="updateField('${today}','${item.serial}','serviceStatus',this.value)">
              <option ${item.serviceStatus=="Waiting"?"selected":""}>Waiting</option>
              <option ${item.serviceStatus=="Serving"?"selected":""}>Serving</option>
              <option ${item.serviceStatus=="Done"?"selected":""}>Done</option>
            </select>
          </td>
        `;
        tbody.appendChild(tr);
      });
    });
  }

  // Update
  function updateField(date,serial,field,val){
    db.ref("bookings/"+date+"/"+serial+"/"+field).set(val);
  }
</script>
</body>
</html>
